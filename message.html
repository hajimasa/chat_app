<!doctype html>
<html lang="en">

<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>Devcha</title>
    <meta name="description" content="簡単にチャットするならDevcha"/>

    <!-- Bootstrap CSS / Color Scheme -->
    <link rel="stylesheet" href="css/default.css" id="theme-color">
</head>

<body>
<script type="text/javascript">

    var connection = "";

    //コネクション開始ボタン

 //   function open_cnn() {

        console.log("コネクションを開始しします。");

        connection = new WebSocket('wss://wo8r0ppuw7.execute-api.ap-northeast-1.amazonaws.com/develop');

        //コネクションが接続された時の動き

        connection.onopen = function (e) {

            console.log("コネクションを開始しまいた。");

        };

        //エラーが発生したされた時の動き

        connection.onerror = function (error) {

            console.log("エラーが発生しました。");

        };

        //メッセージを受け取ったされた時の動き

        connection.onmessage = function (e) {

            let msg = "メッセージを受信しました。" + e.data;

            alert(msg);

        };

        //通信が切断された時の動き

        connection.onclose = function () {

            console.log("コネクションを終了しまいた。");

        };

//    }

    //メッセージ送信ボタン

    function snd_msg() {
      const name = document.getElementById("username").value
      const message = document.getElementById("message").value
	    connection.send(JSON.stringify(
	      {
            action:"sendmessage",
            data:{
              room: "",
              name: username,
              message: message
            }
	      }
	    )
	    );

    }

    //コネクション終了ボタン

    function close_cnn() {

        connection.close();

    }

</script>

  <div class="container-fluid">
    <nav class="navbar navbar-expand-md navbar-dark">
        <a class="navbar-brand heading-black" href="index.html">Devcha</a>
    </nav>
  </div>

  <div class="content">

    <div class="rounded py-2 px-3 ml-3">
      <p class="p-0 m-0">粟田 2020/12/19(土) 20:00:00</p>
      <span>Sit meis deleniti eu, pri vidit meliore docendi ut, an eum erat animal commodo.</span>
    </div>

    <div class="rounded py-2 px-3 ml-3">
      <p class="p-0 m-0">粟田 2020/12/19(土) 20:00:00</p>
      <span>Sit meis deleniti eu, pri vidit meliore docendi ut, an eum erat animal commodo.</span>
    </div>

    <div class="rounded py-2 px-3 ml-3">
      <p class="p-0 m-0">粟田 2020/12/19(土) 20:00:00</p>
      <span>Sit meis deleniti eu, pri vidit meliore docendi ut, an eum erat animal commodo.</span>
    </div>

    <div class="rounded py-2 px-3 ml-3">
      <p class="p-0 m-0">粟田 2020/12/19(土) 20:00:00</p>
      <span>Sit meis deleniti eu, pri vidit meliore docendi ut, an eum erat animal commodo.</span>
    </div>

    <div class="rounded py-2 px-3 ml-3">
      <p class="p-0 m-0">粟田 2020/12/19(土) 20:00:00</p>
      <span>Sit meis deleniti eu, pri vidit meliore docendi ut, an eum erat animal commodo.</span>
    </div>

  </div>

  <div class="flex-grow-0 py-3 px-4">
    <div class="input-group">
      <input type="text" class="form-control m-1" placeholder="名前" id="username">
      <input type="text" class="form-control m-1 w-50" placeholder="メッセージ" id="message">
      <button class="btn btn-primary m-1" onclick="snd_msg()">送信</button>
    </div>
  </div>

</div>

</html>
